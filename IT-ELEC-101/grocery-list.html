<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <!-- SweetAlert2 Library -->
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <style>
  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: Arial, sans-serif;
  }

  .header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px;
    background-color: #f75324; /* Shopee's main color */
    color: white;
  }

  .search-cart-container {
    display: flex;
    align-items: center;
  }

  .container {
    display: inline-block;
    cursor: pointer;
  }

  .bar1, .bar2, .bar3 {
    width: 35px;
    height: 5px;
    background-color: white;
    margin: 6px 0;
    transition: 0.4s;
  }

  .change .bar1 {
    transform: translate(0, 11px) rotate(-45deg);
  }

  .change .bar2 {
    opacity: 0;
  }

  .change .bar3 {
    transform: translate(0, -11px) rotate(45deg);
  }

  /* Fixed sidebar positioning */
  .sidebar { 
    height:50%;
    width: 0;
    position: fixed;
    top: 10px;
    left: 5px;
    background-color: #f75324; /* Shopee's color */
    overflow-x: hidden;
    transition: width 0.3s ease;
    padding-top: 10px;
    z-index: 1000;
    text-align: left;
  }

  .sidebar a {
    padding: 8px 8px;
    text-decoration: none;
    font-size: 18px;
    color: white; /* Shopee's text color */
    display: block;
    transition: 0.3s;
  }

  .sidebar a:hover {
    background-color: #ff6f61; /* A lighter orange for hover effect */
  }

  .sidebar .closebtn {
    position: absolute;
    top: 0;
    right: 10px;
    font-size: 36px;
    color: white;
  }

  #main {
    padding: 16px;
    background-color: #f2f2f2; /* Light gray background */
    min-height: 100vh;
    text-align: center;
  }

  h2 {
    text-align: center;
    margin-top: 20px;
    color: #f75324; /* Shopee's color */
  }

  form {
    background-color: white;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    margin-top: 20px;
  }

  form input, form select {
    display: block;
    margin-bottom: 10px;
    padding: 10px;
    width: 100%;
    max-width: 300px;
    border: 1px solid #ddd;
    border-radius: 4px;
  }

  form button {
    padding: 10px 15px;
    background-color: #f75324; /* Shopee's color */
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
  }

  form button:hover {
    background-color: #ff6f61; /* A lighter orange for hover effect */
  }

  #searchBar {
    padding: 10px;
    width: 200px;
    max-width: 300px;
    border: 1px solid #ddd;
    border-radius: 4px;
    margin-right: 50px;
  }

  .cart-icon {
    font-size: 24px;
    cursor: pointer;
    color: #f75324; /* Shopee's color */
    position: relative;
    right: 10px;
  }

  .cart-icon .item-count {
    background-color: red;
    color: white;
    border-radius: 50%;
    padding: 2px 8px;
    font-size: 14px;
    position: absolute;
    top: -5px;
    right: -10px;
    z-index: 10;
  }

  #item-list {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
    gap: 20px;
    margin-top: 20px;
  }

  .item {
  display: flex;
  flex-direction: column; /* Align items vertically */
  align-items: center; /* Center items horizontally */
  background-color: white;
  padding: 15px;
  border-radius: 8px;
  box-shadow: 0 4px 8px rgba(0,0,0,0.1);
  text-align: center; /* Center text */
}

.item img {
  width: 50px;
  height: 50px;
  border-radius: 8px;
  margin-bottom: 10px; /* Add some space below the image */
}

.item div {
  flex-grow: 1;
  margin: 0;
}

.item div strong {
  font-size: 18px;
  color: #333;
}

.item div p {
  margin: 5px 0;
  font-size: 14px;
  color: #555;
}


  .item button {
  background-color: transparent; /* No background for icon buttons */
  color: #f75324; /* Shopee's color */
  border: none;
  cursor: pointer;
  font-size: 18px; /* Icon size */
  margin-right: 10px;
}

  #cart {
    position: fixed;
    top: 50px;
    right: 10px;
    width: 300px;
    height: calc(100% - 50px);
    background-color: white;
    border: 1px solid #ddd;
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    overflow-y: auto;
    display: none;
    z-index: 1000;
  }

  #cart-items {
    padding: 15px;
  }

  #cart-items .item {
    margin-bottom: 10px;
    background-color: #f9f9f9;
    padding: 10px;
    border-radius: 8px;
  }

.bottom-nav a:hover {
  background-color: #ff6f61; /* A lighter orange for hover effect */
  border-radius: 5px;
  padding: 5px;
}

  @media screen and (max-width: 768px) {
    form input, form select {
      width: 100%;
    }

    .item img {
      width: 40px;
      height: 40px;
    }

    .sidebar a {
      font-size: 15px;
    }

    #main {
      padding: 8px;
    }
  }

  @media screen and (max-width: 600px) {
    .bar1, .bar2, .bar3 {
      width: 30px;
      height: 4px;
    }

    .sidebar a {
      font-size: 14px;
      margin-top: -2px;
    }

    #main {
      padding: 8px;
  
    }
  }
</style>
</head>
<body>

<div id="main">
  <div class="header">
    <div class="container" onclick="toggleSidebar()">
      <div class="bar1"></div>
      <div class="bar2"></div>
      <div class="bar3"></div>
    </div>
    <div class="search-cart-container">
      <input type="text" id="searchBar" placeholder="Search items..." oninput="searchItems()">
      </div>
  </div>
  
  <h2>Grocery List</h2>

  <div id="item-list"></div>
</div>

<div id="cart">
  <h3>Shopping Cart</h3>
  <div id="cart-items"></div>
</div>

<div id="mySidebar" class="sidebar">
  <a href="javascript:void(0)" class="closebtn" onclick="closeSidebar()">&times;</a>
  <a href="shop.html">
    <i class="fas fa-home icon"></i>Home</a>
  <a href="add-item.html">
    <i class="fas fa-add icon"></i>Add Item</a>
  <a href="shop.html">
    <i class="fas fa-shopping-cart icon"></i> Shop</a>

</div>

<script>
  function toggleSidebar() {
    const sidebar = document.getElementById("mySidebar");
    if (sidebar.style.width === "250px") {
      sidebar.style.width = "0";
      document.querySelector(".container").classList.remove("change");
    } else {
      sidebar.style.width = "150px";
      document.querySelector(".container").classList.add("change");
    }
  }

  function closeSidebar() {
    document.getElementById("mySidebar").style.width = "0";
    document.querySelector(".container").classList.remove("change");
  }

  // Function to display the grocery items
  function displayItems(items) {
  const itemList = document.getElementById('item-list');
  itemList.innerHTML = items
    .filter(item => item.status === 'available')
    .map((item, index) => `
      <div class="item">
        <img src="${item.productImage}" alt="${item.productName}" class="item-image">
        <div class="item-details">
          <h3>${item.productName}</h3>
          <p>Brand: ${item.brand}</p>
          <p>Price: ₱${item.price}</p> <!-- Using ₱ for price -->
          <p>Weight/Volume: ${item.weight}</p>
          <p>Quantity: ${item.quantity}</p>
          <p>Store: ${item.store}</p>
          <p>Category: ${item.category}</p>
          <button class="edit-btn" onclick="editItem(${index})">
            <i class="fas fa-edit"></i> 
          </button>
          <button class="remove-btn" onclick="removeItem(${index})">
            <i class="fas fa-trash-alt"></i> 
          </button>
        </div>
      </div>
    `)
    .join('');
}

  // Function to search items based on input
  function searchItems() {
    const searchQuery = document.getElementById('searchBar').value.toLowerCase();
    const items = JSON.parse(localStorage.getItem('items')) || [];
    const filteredItems = items.filter(item =>
      item.productName.toLowerCase().includes(searchQuery) ||
      item.brand.toLowerCase().includes(searchQuery) ||
      item.store.toLowerCase().includes(searchQuery) ||
      item.category.toLowerCase().includes(searchQuery)
    );
    displayItems(filteredItems);
  }

  // Function to edit an item using SweetAlert
  function editItem(index) {
    const items = JSON.parse(localStorage.getItem('items')) || [];
    const item = items[index];

    Swal.fire({
      title: 'Edit Item',
      html: `
        <input id="swal-productName" class="swal2-input" placeholder="Product Name" value="${item.productName}">
        <input id="swal-brand" class="swal2-input" placeholder="Brand" value="${item.brand}">
        <input id="swal-price" class="swal2-input" placeholder="Price (₱)" type="number" value="${item.price}">
        <input id="swal-weight" class="swal2-input" placeholder="Weight/Volume" value="${item.weight}">
        <input id="swal-quantity" class="swal2-input" placeholder="Quantity" type="number" min="1" value="${item.quantity}">
        <input id="swal-store" class="swal2-input" placeholder="Store" value="${item.store}">
        <img id="swal-currentImage" src="${item.productImage}" alt="Current Image" style="max-width: 200px; display: block; margin-top: 10px;">
        <input id="swal-productImage" type="file" accept="image/*" style="margin-top: 10px;">
      `,
      confirmButtonText: 'Save',
      preConfirm: () => {
        return new Promise((resolve) => {
          const productImageFile = document.getElementById('swal-productImage').files[0];
          const reader = new FileReader();
          reader.onloadend = () => {
            resolve({
              productName: document.getElementById('swal-productName').value,
              brand: document.getElementById('swal-brand').value,
              price: document.getElementById('swal-price').value,
              weight: document.getElementById('swal-weight').value,
              quantity: document.getElementById('swal-quantity').value,
              store: document.getElementById('swal-store').value,
              productImage: productImageFile ? reader.result : item.productImage
            });
          };
          if (productImageFile) {
            reader.readAsDataURL(productImageFile);
          } else {
            reader.readAsDataURL(new Blob([])); // Handle empty file case
          }
        });
      }
    }).then((result) => {
      if (result.isConfirmed) {
        items[index] = {
          ...item,
          productName: result.value.productName,
          brand: result.value.brand,
          price: result.value.price,
          weight: result.value.weight,
          quantity: result.value.quantity,
          store: result.value.store,
          productImage: result.value.productImage
        };

        localStorage.setItem('items', JSON.stringify(items));
        searchItems(); // Update display based on search filter
        Swal.fire('Saved!', 'Your item has been updated.', 'success');
      }
    });
  }

  // Function to remove an item using SweetAlert
  function removeItem(index) {
    Swal.fire({
      title: 'Are you sure?',
      text: "You want to delete this!",
      icon: 'warning',
      showCancelButton: true,
      confirmButtonColor: '#3085d6',
      cancelButtonColor: '#d33',
      confirmButtonText: 'Yes',
      cancelButtonText: 'No'
    }).then((result) => {
      if (result.isConfirmed) {
        const items = JSON.parse(localStorage.getItem('items')) || [];
        items.splice(index, 1);
        localStorage.setItem('items', JSON.stringify(items));
        searchItems(); // Update display based on search filter
        Swal.fire('Deleted!', 'Your item has been deleted.', 'success');
      }
    });
  }

  document.addEventListener('DOMContentLoaded', searchItems);
</script>

</body>
</html>
